# MULTICOM4
This is the development repository for the MULTICOM protein structure prediction system for the CASP16 competition. It includes all the programs used in the CASP15 experiment and new programs developed for the CASP16 experiment. 

[Notes for updated tools](Tools_notes.md)

[Notes for updated databases](Database_notes.md)

Monomer

- Adjustable inputs for AlphaFold2-based variants

     | Adjustable inputs  | Description | Choices | default value |
     | -------------| ---------------| ------ | ------ |
     | MSA inputs| MSA sampling | default, original, colabfold, img, deepmsa | default | 
     | Template inputs | Template sampling | pdb70 (default), pdb_sort90 (inhouse template database), no templates | pdb70 (default) |
     | monomer_num_ensemble | number of ensemble | 8 (casp15) |  3 |
     | monomer_num_recycle | number of recycle | 8 (casp15) | 1 |
     | monomer preset | deep learning models for monomer | monomer, monomer_ptm | monomer |
     | dropout | dropout rate during inference | true, false | false |
     | dropout_structure_module | Dropout in structure module at inference | true, false | true (0.1) |
     | predictions_per_model | number of predictions for each model | 1 (casp15) | 1 |
     | relax_topn_predictions | number of predictors that will be relaxed | ALL | ALL |

- AlphaFold2-based predictors

     | Predictor  | MSA | Template | monomer preset | dropout | dropout in structure module | Description |
     | -------- | ----- | ----- | ----- | -----| ----- | ----- |
     | default | default | pdb70 (default) | monomer | false | true (0.1) | default AlphaFold2 | 
     | default_seq_temp | default | pdb_sort90 | monomer | false | true (0.1) | Inhouse template database |
     | original | original | pdb70 (default) | monomer | false | true (0.1) | search MSA seperately |
     | ori_seq_temp | original | pdb_sort90 | monomer | false | true (0.1) | Inhouse template database|
     | colabfold | colabfold | pdb70 (default) | monomer | false | true (0.1) | ColabFold Alignment | 
     | colab_seq_temp | colabfold | pdb_sort90 | monomer | false | true (0.1) | Inhouse template database|
     | img | img | pdb70 (default) | monomer | false | true (0.1) | IMG alignment |
     | img_seq_temp | img | pdb_sort90 | monomer | false | true (0.1) | Inhouse template database|
     | DHR | DHR | pdb70 (default) | monomer | false | true (0.1) | DHR Alignment generated by Pawan's program |
     | def_drop_s | default | pdb70 (default) | monomer | true | true (0.1) | AFSample | 
     | def_drop_nos | default | pdb70 (default) | monomer | true | false | AFSample | 
     | def_notemp | default | no templates | monomer | false | true (0.1) | AFSample |
     | def_notemp_drop_s | default | no templates | monomer | true | true (0.1) | AFSample |
     | def_notemp_drop_nos | default | no templates | monomer | true | false | AFSample |
     | DeepMSA predictors | DeepMSA | pdb70 (default) | monomer | false | true (0.1) | DeepMSA alignments (up to 16) |

     - Post-AlphaFold2-based predictors (requires models generated by default as inputs)

          | Predictor  | MSA | Template | monomer preset | dropout | dropout in structure module | Number of input models | Number of output models | Description |
          | -------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
          | Foldseek refinement | Default + Foldseek | Foldseek | monomer | false | true (0.1) | 5 | 5 | use the top-ranked models generated by default alphafold2 |
          | TMsearch-based predictor | Use TMsearch to search for pdb templates|

     - To be added:

          | Predictor  | Note |
          | -------------| -----| 
          | AFProfile | Need to test it on monomer |

     Number of models to generate:

     About 100 models per AlphaFold2-based variants (MSA, template, dropout), for non-alphafold predictors, use their default settings to generate models.

     For hard targets, use AFsample to generate 500 models per variants (total 2500) in AFsample. For other predictors, increase to 200 models per AlphaFold2-based variants.

- Non-AlphaFold2-based predictors

| Predictor  | Note |
| -------------| -----| 
| Paddle | Paddle-Helix| 
| ESMFold | ESMFold|
| DeepFold | DeepFold |
| MEGAFold | MEGAFold |


b. Multimer

- Adjustable inputs for AlphaFold-Multimer-based variants

     | Adjustable inputs  | Description | Choices | default value |
     | -------------| ---------------| ------ | ------ |
     | $MSA_{unpaired}$ inputs| Monomer MSAs | default, deepmsa | default | 
     | $MSA_{paired}$ inputs| Interaction sources | default, species, string, pdb, unidist, deepmsa | default | 
     | Template inputs | Template sampling | pdb_seqres (default), pdb70, pdb, pdb_complex (inhouse template database), structural template (foldseek), no templates | pdb_seqres (default) |
     | multimer_num_ensemble | number of ensemble | 3 (casp15) |  1 |
     | multimer_num_recycle | number of recycle | 5 (casp15) | 20 |
     | dropout | dropout rate during inference | true, false | false |
     | dropout_structure_module | Dropout in structure module at inference | true, false | true (0.1) |
     | predictions_per_model | number of predictions for each model | 5 (casp15) | 5 |
     | relax_topn_predictions | number of predictors that will be relaxed | ALL | ALL |

- AlphaFold-Multimer-based predictors

     | Predictor  | $MSA_{paired}$ | $MSA_{unpaired}$ | Template | dropout | dropout in structure module | Description |
     | -------------| ---------------| ------ | ------ | ---------------| ------ | ------ |
     | default_multimer | default (uniprot) | default | pdb_seqres | false | true (0.1) | default AlphaFold-Multimer |
     | default_struct | default (uniprot) | default | structural template (foldseek) |  false | true (0.1) | default_struct |
     | default_pdb70 | default (uniprot) | default | pdb70 | false | true (0.1) | default_pdb70 |
     | default_pdb | default (uniprot) | default | pdb | false | true (0.1) | default_pdb |
     | default_comp | default (uniprot) | default | pdb_complex | false | true (0.1) | default_comp |
     | default_af | default (uniprot) | default | alphafold2 predicted structure | false | true (0.1) | default_af |
     | uniclust_oxmatch_a3m | species (unclust30) | default | pdb_seqres | false | true (0.1) | uniclust_oxmatch_a3m |
     | pdb_iter_uniref_a3m | pdb (uniref30) | default | pdb_seqres | false | true (0.1) | pdb_iter_uniref_a3m |
     | pdb_iter_uniref_sto | pdb (uniref90) | default | pdb_seqres | false | true (0.1) | pdb_iter_uniref_sto | 
     | pdb_iter_uniprot_sto | pdb (uniprot) | default | pdb_seqres | false | true (0.1) | pdb_iter_uniprot_sto |
     | spec_iter_uniref_a3m | species (uniref30) | default | pdb_seqres | false | true (0.1) | spec_iter_uniref_a3m |
     | spec_struct | species (uniref30) | default | structural template (foldseek) | false | true (0.1) | spec_struct |
     | spec_pdb70 | species (uniref30) | default | pdb70 | false | true (0.1) | spec_pdb70 |
     | spec_pdb | species (uniref30) | default | pdb | false | true (0.1) | spec_pdb |
     | spec_comp | species (uniref30) | default | pdb_complex | false | true (0.1) | spec_comp |
     | spec_af | species (uniref30) | default | alphafold2 predicted structure | false | true (0.1) | spec_af |
     | spec_iter_uniref_sto | species (uniref90) | default | pdb_seqres | false | true (0.1) | spec_iter_uniref_sto |
     | spec_iter_uniprot_sto | species (uniprot) | default | pdb_seqres | false | true (0.1) | spec_iter_uniprot_sto |
     | unidist_uniref_a3m | unidist (uniref30) | default | pdb_seqres | false | true (0.1) | unidist_uniref_a3m |
     | unidist_uniref_sto | unidist (uniref90) | default | pdb_seqres | false | true (0.1) | unidist_uniref_sto |
     | unidist_uniprot_sto | unidist (uniprot) | default | default | false | true (0.1) | unidist_uniprot_sto |
     | str_iter_uniref_a3m | string (uniref30) | default | pdb_seqres | false | true (0.1) | str_iter_uniref_a3m |
     | str_iter_uniref_sto | string (uniref90) | default | pdb_seqres | false | true (0.1) | str_iter_uniref_sto |
     | str_struct | string (uniref90) | default | default | structural template (foldseek) | false | true (0.1) | str_struct |
     | str_pdb70 | string (uniref90) | default | default | pdb70 | false | true (0.1) | str_pdb70 |
     | str_pdb | string (uniref90) | default | default | pdb | false | true (0.1) | str_pdb |
     | str_comp | string (uniref90) | default | default | pdb_complex | false | true (0.1) | str_comp |
     | str_af | string (uniref90) | default | default | alphafold2 predicted structure | false | true (0.1) | str_af |
     | str_iter_uniprot_sto | string (uniprot) | default | pdb_seqres | false | true (0.1) | str_iter_uniprot_sto |
     | DeepMSA2 predictors | deepmsa | deepmsa | pdb_seqres | false | true (0.1) | DeepMSA2 predictors | 
     | Iterative methods | Foldseek-found paired alignments | input msa + Foldseek-found paired alignments | Foldseek-found templates | false | true (0.1) | Structural-alignment based methods |
     | def_drop_s | default | default | pdb_seqres (default) | true | true (0.1) | AFSample | 
     | def_drop_nos | default | default | pdb_seqres (default) | true | false | AFSample | 
     | def_notemp | default | default | no templates | false | true (0.1) | AFSample |
     | def_notemp_drop_s | default | default | no templates | true | true (0.1) | AFSample |
     | def_notemp_drop_nos | default | default | no templates | true | false | AFSample |
     

To be added: 
| Predictor  | Note |
| -------------| -----| 
| AFProfile | AFProfile | 
| default_multimer | default_multimer no msa pairing | 
| Iterative methods | Iterative methods no msa pairing | 
| Iterative methods | Iterative methods no templates |
| TM-search based template search | TM-search | 

Number of models to generate:

About 500 models per AlphaFold-Multimer-based variant (MSA, template, dropout), select the top 100 models for relaxation and further ranking.

For hard targets, use AFsample to generate 1000 models per variant (total 5000) in AFsample, select the top 200 for relaxation per variant and further ranking. For other predictors, increase to 1000 models per AlphaFold2-based variants, and select the top 200 models for relaxation.

- Non-AlphaFold-Multimer-based predictors

| Predictor  | Note |
| -------------| -----| 
| ESMFold | ESMFold|
